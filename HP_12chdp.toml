########################################################################################################################################################
########################################################################################################################################################
#
#   ______         _____  ______  _______              _____  _______  ______ _______ _______      _______  _____  __   _ _______ _____  ______
#  |  ____ |      |     | |_____] |_____| |           |_____] |_____| |_____/ |_____| |  |  |      |       |     | | \  | |______   |   |  ____
#  |_____| |_____ |_____| |_____] |     | |_____      |       |     | |    \_ |     | |  |  |      |_____  |_____| |  \_| |       __|__ |_____|
#
#
########################################################################################################################################################
########################################################################################################################################################

[statistics]
    exclude_drizzle = 'rg0drizzle'  #   ['disdro', 'anydrizzle', 'rg0drizzle']
    exclude_wet_radome_mwr = 6  #   numer ob time steps after precipitation (1 = 30sec)

[plotting]
    save = true

    [plotting.fig.training_set]
        save = false

    [plotting.fig.training_set_histogram]
        save = false

    [plotting.fig.bsc_dpl_rangespec]
        save = false

    [plotting.fig.plot_spectra_cwt]
        save = false

    [plotting.generic]
        fig_size = [12, 7]
        range_interval = [0, 12000]
        range_converter = true
        contour = true
        dpi = 200

[tensorflow]

    USE_MODEL = 'conv2d'
    OUTPUT_TYPE = 'singletarget'

    BATCH_SIZE   = 256 # √
    BATCH_NORM   = true
    EPOCHS       = 2

    #KERNEL_INITIALIZER = 'random_uniform'
    #REGULARIZER = 'l1_l2'

    DENSE_LAYERS  = [512, 512]
    DROPOUT      = 0.25

    OPTIMIZER   = 'adam'

    # why elu? --> https://arxiv.org/pdf/1511.07289.pdf
    ACTIVATIONS  = 'elu'    # 'relu

    # image classification
    ACTIVATIONS_OL  = 'softmax'
    LOSS_FCNS    = 'SparseCategoricalCrossentropy'
    METRICS = ['sparse_categorical_accuracy']

    # multilable classification
    #ACTIVATIONS_OL  = 'sigmoid'
    #LOSS_FCNS    = 'BinaryCrossentropy'

    LEARNING_RATE = 1.0e-3
    DECAY_RATE = 1.0e-5
    MOMENTUM = 0.9

    # define paths
    VOODOO_PATH  = '/home/sdig/code/larda3/voodoo/'


    #KERNEL_SIZE  = [[3, 1], [3, 1], [3, 1], [3, 1], [3, 1]]
    #STRIDE_SIZE  = [[1, 1], [1, 1], [1, 1], [1, 1], [1, 1]]
    #POOL_SIZE    = [[4, 1], [2, 1], [2, 1], [2, 1], [2, 1]]
    #NFILTERS     = [64, 128, 256, 256, 256]

    #KERNEL_SIZE  = [ [3, 1], [1, 1], [3, 1], [1, 1], [3, 1], [1, 1], [1, 1]]
    #STRIDE_SIZE  = [ [1, 1], [1, 1], [1, 1], [1, 1], [1, 1], [1, 1], [1, 1]]
    #POOL_SIZE    = [ [2, 1], [1, 1], [2, 1], [1, 1], [4, 2], [4, 1], [1, 1]]
    ##NFILTERS     = [64, 32, 128, 64, 256, 128, 512, 256]
    #NFILTERS     = [1024, 512, 2048, 1024, 2048, 1028, 512]

    KERNEL_SIZE  = [ [3, 1], [1, 1], [3, 1], [1, 1], [3, 1], [1, 1]]
    STRIDE_SIZE  = [ [1, 1], [1, 1], [1, 1], [1, 1], [1, 1], [1, 1]]
    POOL_SIZE    = [ [2, 1], [1, 1], [2, 1], [1, 1], [4, 2], [4, 1]]
    #NFILTERS     = [64, 32, 128, 64, 256, 128, 512, 256]
    NFILTERS     = [512, 256, 1024, 512, 1024, 512]



# define normalization boundaries and conversion for radar (feature) and lidar (label) space
[feature]
    quick_check = true
    #remove_ice = 0.0       # remove percentage of samples
    #remove_drizzle = 0.0   # remove percentage of samples
    #n_validation = 2        # use 1 out of n_validation samples for validation

    remove_ice = 0.0       # remove percentage of samples
    remove_drizzle = 0.0   # remove percentage of samples
    n_validation = 5        # use 1 out of n_validation samples for validation

    [feature.generic]
        scaling = '-'
        use = false

    [feature.VSpec]
        use = true
        add_flipped = false
        var_lims = [1.0e-7, 1.0e2]
        var_converter= 'lin2z'
        scaling = 'normalize'
        despeckle2D = true          # 2D convolution (5x5 window), removes single non-zero values,
        main_peak = true            #
        ghost_echo_1 = false         # reduces the domain (Nyquist velocitdy) by ± 2.5 [m/s], when signal > 0 [dBZ] within 200m above antenna
        ghost_echo_2 = true         #
        dealiasing = false         #
        add_horizontal_channel = true


# define normalization boundaries and conversion for radar (feature) and lidar (label) space
[target.info]
    [target.info.generic]
        scaling = 'normalize'

    [target.info.attbsc1064]
        var_lims = [1.0e-7, 1.0e-3]
        var_converter= 'log'
        scaling = ''
        use = false

    [target.info.depol]
        var_lims = [1.0e-7, 0.3]
        var_converter= 'ldr2cdr'
        scaling = ''
        use = false

